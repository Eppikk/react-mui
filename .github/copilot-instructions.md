# React + MUI Template - Copilot Instructions

## Project Overview

Minimal React 19 + TypeScript + Material-UI template using Vite with absolute path imports. Includes Emotion styling, MUI Icons, and Prettier formatting.

## Tech Stack & Key Decisions

- **Build Tool**: Vite using `rolldown-vite@7.2.5` (experimental Rust-based bundler via npm override)
- **UI Library**: Material-UI v7 with Emotion for styling (`@mui/material`, `@mui/icons-material`)
- **React**: Version 19.2.0 with StrictMode enabled in [src/main.tsx](src/main.tsx)
- **TypeScript**: Strict mode with project references and path aliases configured
- **Formatting**: Prettier with single quotes, no semicolons (see [.prettierrc](.prettierrc))
- **Linting**: ESLint 9+ flat config with React Hooks and React Refresh plugins

## Development Workflow

```bash
npm run dev           # Start dev server with HMR
npm run build         # TypeScript check + production build
npm run lint          # ESLint check
npm run format        # Format code with Prettier
npm run format:check  # Check code formatting
npm run preview       # Preview production build locally
```

**Note**: Build script runs `tsc -b` before Vite build to ensure type checking (Vite skips this by default).

## Code Conventions

### Import Paths (vite-tsconfig-paths)

Use absolute imports from the `src` directory (baseUrl is set to "src" in [tsconfig.app.json](tsconfig.app.json)):

```tsx
import { MyComponent } from 'components/MyComponent' // src/components/*
import { useCustomHook } from 'hooks/useCustomHook' // src/hooks/*
import { formatDate } from 'utils/formatDate' // src/utils/*
import type { User } from 'types/user' // src/types/*
```

**Never** use relative imports like `../../../components` - always use absolute imports from src root.

### Material-UI Patterns

- Import components from `@mui/material`: `import { Button, Box } from '@mui/material'`
- Import icons from `@mui/icons-material`: `import AddIcon from '@mui/icons-material/Add'`
- Use `sx` prop for component-specific styles (avoids separate CSS files)
- Wrap app in `ThemeProvider` in [src/main.tsx](src/main.tsx) for custom themes
- **MUI API Reference**: Use the MUI MCP server for component API documentation, props, and usage examples when needed
  - Access via `@mui-mcp` for detailed component specifications
  - Consult for prop types, default values, theme integration, and best practices
  - Helpful for complex components (DataGrid, Autocomplete, Stepper, etc.)

### TypeScript Configuration

- Use `bundler` module resolution (not `node16`)
- Include `.tsx` extensions in imports allowed (`allowImportingTsExtensions: true`)
- Strict linting: `noUnusedLocals`, `noUnusedParameters`, `noFallthroughCasesInSwitch`
- Separate configs for app ([tsconfig.app.json](tsconfig.app.json)) and tools ([tsconfig.node.json](tsconfig.node.json))

### ESLint & Prettier

- ESLint uses flat config format (`eslint.config.js`) with `defineConfig`
- Prettier runs before commits - use `npm run format` to auto-fix
- Config: single quotes, no semicolons, trailing commas ES5, 100 char width
- Always ignore `dist/` and `node_modules/` in [.prettierignore](.prettierignore)

### React Patterns

- Functional components only
- Hooks for state management (`useState`, `useEffect`)
- TSX files use `.tsx` extension explicitly in imports
- Entry point is [src/main.tsx](src/main.tsx) with `createRoot` API
- Router configuration in [src/router.tsx](src/router.tsx)
- Auth context provided by [src/auth/AuthProvider.tsx](src/auth/AuthProvider.tsx)

### Environment Variables

- Environment variables accessed via `import.meta.env.VITE_*`
- TypeScript types defined in [src/vite-env.d.ts](src/vite-env.d.ts)
- [.env.development](.env.development) - Development environment config
- [.env.production](.env.production) - Production environment config
- [.env.example](.env.example) - Template for required variables
- Required variables: `VITE_API_URL`, `VITE_APP_NAME`, `VITE_APP_VERSION`
- Use directly: `const apiUrl = import.meta.env.VITE_API_URL`

### Routing (TanStack Router - File-Based)

- Uses **file-based routing** with automatic route generation
- Route files in `src/routes/` are automatically discovered and configured
- File naming convention: `src/routes/my-page.tsx` creates route at `/my-page`
- Index routes: `src/routes/index.tsx` maps to `/`
- **Root route**: `src/routes/__root.tsx` provides the layout wrapper for all routes
- Export component using `createFileRoute`: `export const Route = createFileRoute('/my-page')({ component: MyComponent })`
- Route tree is auto-generated by TanStack Router plugin - no manual registration needed
- Type safety is automatic via code generation
- **TanStack Documentation**: Use the TanStack MCP server for routing documentation, API reference, and best practices
  - Access via `@tanstack-mcp` for detailed TanStack Router, Query, Table, Form, and other library docs
  - Consult for routing patterns, hooks, navigation, search params, and advanced features

## File Structure

### Standard Folder Organization

```
src/
  main.tsx           # Application entry point with providers (Theme, Auth, Router, Query)
  router.tsx         # Router configuration and context
  routeTree.gen.ts   # Auto-generated route tree (do not edit manually)
  index.css          # CSS reset and base styles

  auth/              # Authentication context and hooks
    AuthProvider.tsx # Auth context provider with token management
    useAuth.ts       # Auth hook for consuming auth context
    types.ts         # Auth-related TypeScript types

  components/        # Reusable UI components
    Dashboard.tsx
    Navbar.tsx
    common/          # Shared/generic components
      Button.tsx
      Modal.tsx
    layout/          # Layout components
      Header.tsx
      Sidebar.tsx
      Footer.tsx

  hooks/             # Custom React hooks
    useAuth.ts
    useLocalStorage.ts
    useFetch.ts

  auth/              # Authentication context and state
    AuthProvider.tsx # Auth provider with login/logout
    useAuth.ts       # Auth context hook
    types.ts         # Auth types (User, etc.)

  api/               # API client and service layer
    client.ts        # Axios instance with bearer token interceptor
    types.ts         # Common API response types
    index.ts         # Barrel exports for clean imports
    services/        # API service modules
      auth.ts        # Login, register, logout, getCurrentUser
      users.ts       # User CRUD operations

  config/            # Configuration files
    theme.ts         # MUI theme configuration
    constants.ts     # App-wide constants
    env.ts           # Environment variables

  utils/             # Helper functions and utilities
    formatDate.ts
    validators.ts
    storage.ts

  types/             # TypeScript types/interfaces
    user.ts
    api.ts
    common.ts

  routes/            # Route definitions (TanStack Router)
    __root.tsx
    index.tsx
    about.tsx

  assets/            # Static assets
    images/
    fonts/
    icons/
```

### Folder Guidelines

**components/** - UI components organized by feature or type

- Export components as default: `export default function Dashboard() {}`
- Use PascalCase for component files: `MyComponent.tsx`
- Group related components in subfolders: `components/auth/LoginForm.tsx`
- Common/shared components go in `components/common/`
- Layout components (Header, Sidebar, Footer) go in `components/layout/`

**auth/** - Authentication context and hooks

- `AuthProvider.tsx` - Provides authentication state to the app
- `useAuth.ts` - Hook to consume auth context
- Automatically checks for stored token on mount
- Integrates with API services for login/logout
- Import: `import { useAuth } from 'auth'`

**hooks/** - Custom React hooks following naming convention

- Prefix with `use`: `useAuth.ts`, `useDebounce.ts`
- Export as named export: `export function useAuth() {}`
- One hook per file unless tightly coupled
- Import: `import { useAuth } from 'hooks/useAuth'`

**api/** - Centralized API layer

- `api/client.ts` - Base HTTP client setup (axios instance, interceptors)
- `api/services/` - API methods grouped by domain/resource
- Return typed responses: `Promise<User>`, `Promise<Product[]>`
- Handle errors consistently in client or services
- Example: `import { getUsers } from 'api/services/users'`

**config/** - Configuration and setup files

- `theme.ts` - MUI theme customization (colors, typography, components)
- `i18n.ts` - i18next configuration for internationalization
- `locales/` - Translation files (en.json, fi.json, etc.)
- `constants.ts` - App constants (feature flags, enums)
- Export const objects: `export const theme = createTheme({...})`

**utils/** - Pure utility functions

- Small, reusable helpers that don't depend on React
- Export named functions: `export function formatCurrency(value: number) {}`
- Keep functions focused and testable
- Examples: formatters, validators, converters, parsers

**types/** - TypeScript type definitions

- Organize by domain: `user.ts`, `product.ts`, `api.ts`
- Use interfaces for objects: `export interface User {}`
- Use types for unions/intersections: `export type Status = 'active' | 'inactive'`
- Common/shared types in `types/common.ts`

**routes/** - Route components (TanStack Router)

- File-based routing: `__root.tsx`, `index.tsx`, `about.tsx`
- Each route exports a route definition
- Import components from `components/` for route content

## Common Gotchas

- **Vite Override**: This template uses `rolldown-vite` instead of standard Vite. If tooling behaves unexpectedly, check the override in [package.json](package.json).
- **Absolute Imports**: Require `vite-tsconfig-paths` plugin - already configured in [vite.config.ts](vite.config.ts). BaseUrl is set to "src" for cleaner imports.
- **Type-Aware Linting**: Not enabled by default. To add, follow [README.md](README.md) for `tseslint.configs.recommendedTypeChecked`.
- **React Compiler**: Intentionally disabled for performance (see [README.md](README.md)).
- **Prettier Conflicts**: ESLint doesn't include formatting rules - use Prettier for all formatting.

## Key Files to Reference

- [vite.config.ts](vite.config.ts) - Vite config with React plugin and tsconfig paths
- [tsconfig.app.json](tsconfig.app.json) - TypeScript config with baseUrl set to src
- [eslint.config.js](eslint.config.js) - Flat config with React plugins
- [.prettierrc](.prettierrc) - Code formatting rules
